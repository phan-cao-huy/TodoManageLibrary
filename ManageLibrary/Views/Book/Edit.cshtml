@model ManageLibrary.Models.Book

@{
    ViewData["Title"] = "Chỉnh sửa sách";
    Layout = "~/Views/Shared/Layout.cshtml";
}

<div class="container-fluid px-4">
    <h3 class="text-center my-4">Chỉnh sửa sách (Mã: @Model.BookId)</h3>

    <form asp-action="Edit" asp-controller="Book" method="post" id="edit-book-form" class="mx-auto" style="max-width:600px;">

        @Html.AntiForgeryToken()

        <div asp-validation-summary="ModelOnly" class="text-danger mb-3"></div>

        <!-- Mã sách ở chế độ chỉ đọc (readonly) -->
        <div class="mb-3">
            <label asp-for="BookId" class="form-label">Mã sách</label>
            <input asp-for="BookId" class="form-control" readonly />
            <span asp-validation-for="BookId" class="text-danger"></span>
        </div>

        <div class="mb-3">
            <label asp-for="Name" class="form-label">Tên sách</label>
            <input asp-for="Name" class="form-control" />
            <span asp-validation-for="Name" class="text-danger"></span>
        </div>

        <div class="mb-3">
            <label asp-for="AuthorId" class="form-label">Tác giả</label>
            <select asp-for="AuthorId" asp-items="ViewBag.Authors" class="form-select">
                <option value="">-- Chọn tác giả --</option>
            </select>
            <span asp-validation-for="AuthorId" class="text-danger"></span>
        </div>

        <div class="mb-3">
            <label asp-for="PublisherId" class="form-label">Nhà xuất bản</label>
            <select asp-for="PublisherId" asp-items="ViewBag.Publishers" class="form-select">
                <option value="">-- Chọn nhà xuất bản --</option>
            </select>
            <span asp-validation-for="PublisherId" class="text-danger"></span>
        </div>

        <div class="mb-3">
            <label asp-for="CategoryId" class="form-label">Thể loại</label>
            <select asp-for="CategoryId" asp-items="ViewBag.Categories" class="form-select">
                <option value="">-- Chọn thể loại --</option>
            </select>
            <span asp-validation-for="CategoryId" class="text-danger"></span>
        </div>

        <div class="row g-3">
            <div class="col-md-6 mb-3">
                <label asp-for="YearOfPublic" class="form-label">Năm xuất bản</label>
                <input asp-for="YearOfPublic" class="form-control" type="number" />
                <span asp-validation-for="YearOfPublic" class="text-danger"></span>
            </div>

            <div class="col-md-6 mb-3">
                <label asp-for="Position" class="form-label">Vị trí</label>
                <input asp-for="Position" class="form-control" />
                <span asp-validation-for="Position" class="text-danger"></span>
            </div>
        </div>

        <div class="row g-3">
            <div class="col-md-4 mb-3">
                <label asp-for="Cost" class="form-label">Giá (VNĐ)</label>
                <input asp-for="Cost" class="form-control" type="number" />
                <span asp-validation-for="Cost" class="text-danger"></span>
            </div>

            <div class="col-md-4 mb-3">
                <label asp-for="NumOfPage" class="form-label">Số trang</label>
                <input asp-for="NumOfPage" class="form-control" type="number" />
                <span asp-validation-for="NumOfPage" class="text-danger"></span>
            </div>

            <!-- *** Thêm trường Số lượng *** -->
            <div class="col-md-4 mb-3">
                <label asp-for="Quantity" class="form-label">Số lượng</label>
                <input asp-for="Quantity" class="form-control" type="number" />
                <span asp-validation-for="Quantity" class="text-danger"></span>
            </div>
        </div>
    </form>

    <!-- Hàng nút hành động: trái = Xóa, phải = Hủy + Lưu -->
    <div class="mx-auto" style="max-width:600px;">
        <div class="d-flex justify-content-between align-items-center mt-2">
            <div>
                <form asp-action="Delete" asp-controller="Book" asp-route-id="@Model.BookId" method="post" class="d-inline"
                      onsubmit="return confirm('Bạn có chắc muốn xóa sách @Model.Name (ID: @Model.BookId) không?');">
                    @Html.AntiForgeryToken()
                    <button type="submit" class="btn btn-danger">
                        <i class="fas fa-trash"></i> Xóa sách
                    </button>
                </form>
            </div>
            <div class="text-end">
                <a asp-action="Index" asp-controller="Book" class="btn btn-secondary me-2">Hủy</a>
                <button type="submit" class="btn btn-warning" form="edit-book-form">Lưu thay đổi</button>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
}
